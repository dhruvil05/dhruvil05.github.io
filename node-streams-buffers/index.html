<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Streams & Buffers Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #0f766e 0%, #14b8a6 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 2rem;
            color: #2d3748;
            margin-bottom: 30px;
            padding-bottom: 10px;
            border-bottom: 3px solid #14b8a6;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .topic {
            background: #f0fdfa;
            border-left: 4px solid #14b8a6;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .topic:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(20, 184, 166, 0.2);
        }

        .topic-header {
            font-size: 1.3rem;
            font-weight: bold;
            color: #0f766e;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .toggle-icon {
            font-size: 1.5rem;
            transition: transform 0.3s ease;
        }

        .toggle-icon.active {
            transform: rotate(180deg);
        }

        .topic-content {
            color: #4a5568;
            line-height: 1.8;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease;
        }

        .topic-content.active {
            max-height: 4000px;
            margin-top: 15px;
        }

        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .code-comment {
            color: #94a3b8;
        }

        .code-string {
            color: #86efac;
        }

        .code-keyword {
            color: #c084fc;
        }

        .code-function {
            color: #60a5fa;
        }

        .interactive-demo {
            background: white;
            border: 2px solid #14b8a6;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .demo-title {
            font-weight: bold;
            color: #0f766e;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .btn {
            background: linear-gradient(135deg, #0f766e 0%, #14b8a6 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(20, 184, 166, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #64748b 0%, #94a3b8 100%);
        }

        .output-box {
            background: #f8fafc;
            border: 2px dashed #cbd5e0;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            min-height: 60px;
            font-family: 'Courier New', monospace;
            color: #2d3748;
            max-height: 400px;
            overflow-y: auto;
        }

        .output-line {
            padding: 5px 0;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .highlight {
            background: #fef3c7;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }

        .key-point {
            background: #dbeafe;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .warning-box {
            background: #fee2e2;
            border-left: 4px solid #ef4444;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .success-box {
            background: #d1fae5;
            border-left: 4px solid #10b981;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .info-box {
            background: #e0f2fe;
            border-left: 4px solid #0ea5e9;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .visual-demo {
            background: linear-gradient(135deg, #f0fdfa 0%, #ccfbf1 100%);
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
        }

        .buffer-visual {
            display: flex;
            gap: 5px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .buffer-byte {
            width: 50px;
            height: 50px;
            background: #14b8a6;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .buffer-byte:hover {
            transform: scale(1.1);
            background: #0f766e;
        }

        .stream-visual {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .stream-box {
            padding: 20px;
            background: white;
            border: 2px solid #14b8a6;
            border-radius: 8px;
            min-width: 120px;
            text-align: center;
            font-weight: bold;
            color: #0f766e;
        }

        .stream-arrow {
            font-size: 2rem;
            color: #14b8a6;
        }

        .chunk {
            display: inline-block;
            padding: 8px 12px;
            background: #14b8a6;
            color: white;
            border-radius: 4px;
            margin: 5px;
            font-family: 'Courier New', monospace;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(-50px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .comparison-table th,
        .comparison-table td {
            border: 2px solid #cbd5e0;
            padding: 12px;
            text-align: left;
        }

        .comparison-table th {
            background: #14b8a6;
            color: white;
            font-weight: bold;
        }

        .comparison-table tr:nth-child(even) {
            background: #f0fdfa;
        }

        .input-group {
            margin: 15px 0;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #0f766e;
        }

        .input-group input,
        .input-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #cbd5e0;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .input-group input:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: #14b8a6;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }

            .section-title {
                font-size: 1.5rem;
            }

            .content {
                padding: 20px;
            }

            .buffer-byte {
                width: 40px;
                height: 40px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>💾 Streams & Buffers</h1>
            <p>Complete Interactive Guide to Binary Data and Streaming in Node.js</p>
        </div>

        <div class="content">
            <!-- BUFFERS SECTION -->
            <div class="section">
                <h2 class="section-title">
                    <span>📦 Buffers</span>
                </h2>

                <div class="topic" onclick="toggleTopic(this)">
                    <div class="topic-header">
                        <span>🎯 What is a Buffer?</span>
                        <span class="toggle-icon">▼</span>
                    </div>
                    <div class="topic-content">
                        <p>A <span class="highlight">Buffer</span> is a temporary storage area in memory that holds
                            binary data. Think of it as an array of bytes.</p>

                        <div class="key-point">
                            <strong>💡 Why Buffers?</strong>
                            <ul style="margin-top: 10px; margin-left: 20px;">
                                <li>JavaScript was designed for text (strings)</li>
                                <li>Node.js needs to handle binary data (files, images, videos)</li>
                                <li>Buffers bridge the gap between JavaScript and binary data</li>
                                <li>Efficient way to work with raw data</li>
                            </ul>
                        </div>

                        <div class="visual-demo">
                            <h3 style="margin-bottom: 15px;">Buffer Visualization</h3>
                            <p style="margin-bottom: 10px;">Each box represents one byte (8 bits)</p>
                            <div class="buffer-visual" id="buffer-visual-1">
                                <!-- Will be populated by JavaScript -->
                            </div>
                            <p style="margin-top: 10px; font-size: 0.9rem; color: #64748b;">Buffer for "Hello" = 5 bytes
                            </p>
                        </div>

                        <div class="code-block">
                            <span class="code-comment">// Creating a buffer from a string</span>
                            <span class="code-keyword">const</span> buffer = Buffer.from(<span
                                class="code-string">'Hello'</span>);

                            console.log(buffer);
                            <span class="code-comment">// &lt;Buffer 48 65 6c 6c 6f&gt; (hexadecimal)</span>

                            console.log(buffer[0]);
                            <span class="code-comment">// 72 (ASCII code for 'H')</span>
                        </div>
                    </div>
                </div>

                <div class="topic" onclick="toggleTopic(this)">
                    <div class="topic-header">
                        <span>🛠️ Creating Buffers</span>
                        <span class="toggle-icon">▼</span>
                    </div>
                    <div class="topic-content">
                        <div class="code-block">
                            <span class="code-comment">// Method 1: Buffer.alloc() - Safe, filled with zeros</span>
                            <span class="code-keyword">const</span> buf1 = Buffer.alloc(10);
                            <span class="code-comment">// Creates 10-byte buffer: &lt;Buffer 00 00 00 00 00 00 00 00 00
                                00&gt;</span>

                            <span class="code-comment">// Method 2: Buffer.from() - From string</span>
                            <span class="code-keyword">const</span> buf2 = Buffer.from(<span
                                class="code-string">'Hello'</span>);
                            <span class="code-comment">// &lt;Buffer 48 65 6c 6c 6f&gt;</span>

                            <span class="code-comment">// Method 3: Buffer.from() - From array</span>
                            <span class="code-keyword">const</span> buf3 = Buffer.from([72, 101, 108, 108, 111]);
                            <span class="code-comment">// &lt;Buffer 48 65 6c 6c 6f&gt; (same as "Hello")</span>

                            <span class="code-comment">// Method 4: Buffer.allocUnsafe() - Faster but contains old
                                data</span>
                            <span class="code-keyword">const</span> buf4 = Buffer.allocUnsafe(10);
                            <span class="code-comment">// ⚠️ May contain sensitive data from memory!</span>
                        </div>

                        <div class="interactive-demo">
                            <div class="demo-title">🎮 Try Creating Buffers:</div>

                            <div class="input-group">
                                <label>Enter text to convert to buffer:</label>
                                <input type="text" id="buffer-input" value="Hello World"
                                    placeholder="Type something...">
                            </div>

                            <button class="btn" onclick="createBuffer()">Create Buffer</button>
                            <button class="btn btn-secondary" onclick="showBufferHex()">Show Hexadecimal</button>
                            <button class="btn btn-secondary" onclick="showBufferArray()">Show as Array</button>

                            <div class="output-box" id="buffer-output"></div>
                        </div>
                    </div>
                </div>

                <div class="topic" onclick="toggleTopic(this)">
                    <div class="topic-header">
                        <span>📚 Buffer Methods</span>
                        <span class="toggle-icon">▼</span>
                    </div>
                    <div class="topic-content">
                        <div class="code-block">
                            <span class="code-comment">// .toString([encoding]) - Convert to string</span>
                            <span class="code-keyword">const</span> buf = Buffer.from(<span
                                class="code-string">'Hello'</span>);
                            buf.toString(); <span class="code-comment">// 'Hello'</span>
                            buf.toString(<span class="code-string">'hex'</span>); <span class="code-comment">//
                                '48656c6c6f'</span>
                            buf.toString(<span class="code-string">'base64'</span>); <span class="code-comment">//
                                'SGVsbG8='</span>

                            <span class="code-comment">// .write(string) - Write to buffer</span>
                            <span class="code-keyword">const</span> buf2 = Buffer.alloc(10);
                            buf2.write(<span class="code-string">'Hi'</span>);
                            console.log(buf2.toString()); <span class="code-comment">// 'Hi'</span>

                            <span class="code-comment">// .length - Get buffer size</span>
                            console.log(buf.length); <span class="code-comment">// 5 bytes</span>

                            <span class="code-comment">// .slice(start, end) - Extract portion</span>
                            <span class="code-keyword">const</span> sliced = buf.slice(0, 2);
                            console.log(sliced.toString()); <span class="code-comment">// 'He'</span>

                            <span class="code-comment">// .copy(target) - Copy buffer</span>
                            <span class="code-keyword">const</span> target = Buffer.alloc(5);
                            buf.copy(target);

                            <span class="code-comment">// Buffer.concat([buffers]) - Join buffers</span>
                            <span class="code-keyword">const</span> buf3 = Buffer.from(<span class="code-string">'
                                World'</span>);
                            <span class="code-keyword">const</span> combined = Buffer.concat([buf, buf3]);
                            console.log(combined.toString()); <span class="code-comment">// 'Hello World'</span>

                            <span class="code-comment">// .equals(buffer) - Check equality</span>
                            buf.equals(buf2); <span class="code-comment">// false</span>

                            <span class="code-comment">// .compare(buffer) - Compare buffers</span>
                            buf.compare(buf2); <span class="code-comment">// Returns -1, 0, or 1</span>
                        </div>

                        <div class="interactive-demo">
                            <div class="demo-title">🎮 Try Buffer Methods:</div>

                            <button class="btn" onclick="demoBufferSlice()">Slice Buffer</button>
                            <button class="btn" onclick="demoBufferConcat()">Concat Buffers</button>
                            <button class="btn" onclick="demoBufferCopy()">Copy Buffer</button>
                            <button class="btn" onclick="demoBufferEncodings()">Show Encodings</button>

                            <div class="output-box" id="buffer-methods-output"></div>
                        </div>
                    </div>
                </div>

                <div class="topic" onclick="toggleTopic(this)">
                    <div class="topic-header">
                        <span>🎨 Buffer Encodings</span>
                        <span class="toggle-icon">▼</span>
                    </div>
                    <div class="topic-content">
                        <p>Buffers can be converted to different encoding formats:</p>

                        <div class="info-box">
                            <strong>📋 Supported Encodings:</strong>
                            <ul style="margin-top: 10px; margin-left: 20px;">
                                <li><span class="highlight">utf8</span> - Default, multi-byte encoding</li>
                                <li><span class="highlight">ascii</span> - 7-bit ASCII encoding</li>
                                <li><span class="highlight">base64</span> - Base64 encoding</li>
                                <li><span class="highlight">hex</span> - Hexadecimal encoding</li>
                                <li><span class="highlight">latin1</span> - Latin-1 encoding</li>
                                <li><span class="highlight">binary</span> - Alias for latin1</li>
                            </ul>
                        </div>

                        <div class="code-block">
                            <span class="code-keyword">const</span> buf = Buffer.from(<span class="code-string">'Hello
                                World'</span>);

                            console.log(buf.toString(<span class="code-string">'utf8'</span>));
                            <span class="code-comment">// 'Hello World'</span>

                            console.log(buf.toString(<span class="code-string">'hex'</span>));
                            <span class="code-comment">// '48656c6c6f20576f726c64'</span>

                            console.log(buf.toString(<span class="code-string">'base64'</span>));
                            <span class="code-comment">// 'SGVsbG8gV29ybGQ='</span>

                            <span class="code-comment">// Create buffer from different encodings</span>
                            <span class="code-keyword">const</span> hexBuf = Buffer.from(<span
                                class="code-string">'48656c6c6f'</span>, <span class="code-string">'hex'</span>);
                            console.log(hexBuf.toString()); <span class="code-comment">// 'Hello'</span>

                            <span class="code-keyword">const</span> base64Buf = Buffer.from(<span
                                class="code-string">'SGVsbG8='</span>, <span class="code-string">'base64'</span>);
                            console.log(base64Buf.toString()); <span class="code-comment">// 'Hello'</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- STREAMS SECTION -->
            <div class="section">
                <h2 class="section-title">
                    <span>🌊 Streams</span>
                </h2>

                <div class="topic" onclick="toggleTopic(this)">
                    <div class="topic-header">
                        <span>🎯 What is a Stream?</span>
                        <span class="toggle-icon">▼</span>
                    </div>
                    <div class="topic-content">
                        <p>A <span class="highlight">Stream</span> is a collection of data that might not be available
                            all at once. Streams let you process data piece by piece (chunks) instead of loading
                            everything into memory.</p>

                        <div class="key-point">
                            <strong>💡 Why Streams?</strong>
                            <ul style="margin-top: 10px; margin-left: 20px;">
                                <li>✅ <strong>Memory Efficient</strong> - Process large files without loading entire
                                    file</li>
                                <li>✅ <strong>Time Efficient</strong> - Start processing before all data arrives</li>
                                <li>✅ <strong>Composable</strong> - Chain streams together with pipes</li>
                                <li>✅ <strong>Handle Large Data</strong> - Videos, logs, huge files</li>
                            </ul>
                        </div>

                        <div class="visual-demo">
                            <h3 style="margin-bottom: 15px;">Stream Flow Visualization</h3>
                            <div class="stream-visual">
                                <div class="stream-box">SOURCE<br>(File)</div>
                                <div class="stream-arrow">→</div>
                                <div class="stream-box">CHUNK 1</div>
                                <div class="stream-arrow">→</div>
                                <div class="stream-box">CHUNK 2</div>
                                <div class="stream-arrow">→</div>
                                <div class="stream-box">CHUNK 3</div>
                                <div class="stream-arrow">→</div>
                                <div class="stream-box">DESTINATION</div>
                            </div>
                            <p style="margin-top: 15px; color: #64748b;">Data flows in small chunks, not all at once!
                            </p>
                        </div>

                        <div class="info-box">
                            <strong>🔄 Stream Analogy:</strong>
                            <p style="margin-top: 10px;">Think of a stream like a water pipe:</p>
                            <ul style="margin-top: 10px; margin-left: 20px;">
                                <li>Water (data) flows continuously</li>
                                <li>You don't need to fill a bucket first</li>
                                <li>You can process water as it flows</li>
                                <li>You can connect pipes together</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="topic" onclick="toggleTopic(this)">
                    <div class="topic-header">
                        <span>📂 Types of Streams</span>
                        <span class="toggle-icon">▼</span>
                    </div>
                    <div class="topic-content">
                        <div class="success-box">
                            <strong>1️⃣ Readable Streams</strong>
                            <p style="margin-top: 10px;">Data you can <strong>read from</strong> (source)</p>
                            <p>Examples: fs.createReadStream(), http.IncomingMessage, process.stdin</p>
                        </div>

                        <div class="code-block">
                            <span class="code-comment">// Readable Stream Example</span>
                            <span class="code-keyword">const</span> fs = require(<span class="code-string">'fs'</span>);

                            <span class="code-keyword">const</span> readStream = fs.createReadStream(<span
                                class="code-string">'file.txt'</span>, {
                            encoding: <span class="code-string">'utf8'</span>,
                            highWaterMark: 64 * 1024 <span class="code-comment">// 64KB chunks</span>
                            });

                            <span class="code-comment">// Reading data chunk by chunk</span>
                            readStream.on(<span class="code-string">'data'</span>, (chunk) => {
                            console.log(<span class="code-string">'Received chunk:'</span>, chunk.length, <span
                                class="code-string">'bytes'</span>);
                            });

                            readStream.on(<span class="code-string">'end'</span>, () => {
                            console.log(<span class="code-string">'Finished reading'</span>);
                            });

                            readStream.on(<span class="code-string">'error'</span>, (err) => {
                            console.error(<span class="code-string">'Error:'</span>, err);
                            });
                        </div>

                        <div class="success-box">
                            <strong>2️⃣ Writable Streams</strong>
                            <p style="margin-top: 10px;">Data you can <strong>write to</strong> (destination)</p>
                            <p>Examples: fs.createWriteStream(), http.ServerResponse, process.stdout</p>
                        </div>

                        <div class="code-block">
                            <span class="code-comment">// Writable Stream Example</span>
                            <span class="code-keyword">const</span> writeStream = fs.createWriteStream(<span
                                class="code-string">'output.txt'</span>);

                            writeStream.write(<span class="code-string">'Hello '</span>);
                            writeStream.write(<span class="code-string">'World\n'</span>);
                            writeStream.end(<span class="code-string">'Final data'</span>);

                            writeStream.on(<span class="code-string">'finish'</span>, () => {
                            console.log(<span class="code-string">'All data written'</span>);
                            });
                        </div>

                        <div class="success-box">
                            <strong>3️⃣ Duplex Streams</strong>
                            <p style="margin-top: 10px;">Both <strong>readable and writable</strong></p>
                            <p>Examples: TCP sockets, zlib streams</p>
                        </div>

                        <div class="success-box">
                            <strong>4️⃣ Transform Streams</strong>
                            <p style="margin-top: 10px;"><strong>Modify data</strong> as it passes through</p>
                            <p>Examples: zlib.createGzip(), crypto.createCipher()</p>
                        </div>

                        <div class="code-block">
                            <span class="code-comment">// Transform Stream Example</span>
                            <span class="code-keyword">const</span> { Transform } = require(<span
                                class="code-string">'stream'</span>);

                            <span class="code-keyword">const</span> upperCase = <span class="code-keyword">new</span>
                            Transform({
                            transform(chunk, encoding, callback) {
                            <span class="code-keyword">this</span>.push(chunk.toString().toUpperCase());
                            callback();
                            }
                            });

                            <span class="code-comment">// Usage: converts input to uppercase</span>
                            process.stdin.pipe(upperCase).pipe(process.stdout);
                        </div>
                    </div>
                </div>

                <div class="topic" onclick="toggleTopic(this)">
                    <div class="topic-header">
                        <span>🔗 Piping Streams</span>
                        <span class="toggle-icon">▼</span>
                    </div>
                    <div class="topic-content">
                        <p>The most powerful feature of streams - <span class="highlight">connect streams
                                together</span>!</p>

                        <div class="visual-demo">
                            <h3 style="margin-bottom: 15px;">Pipe Chain Visualization</h3>
                            <div class="stream-visual">
                                <div class="stream-box">READ</div>
                                <div class="stream-arrow">pipe()</div>
                                <div class="stream-box">TRANSFORM</div>
                                <div class="stream-arrow">pipe()</div>
                                <div class="stream-box">WRITE</div>
                            </div>
                        </div>

                        <div class="code-block">
                            <span class="code-comment">// Simple pipe: Read → Write</span>
                            fs.createReadStream(<span class="code-string">'input.txt'</span>)
                            .pipe(fs.createWriteStream(<span class="code-string">'output.txt'</span>));

                            <span class="code-comment">// Complex pipe chain: Read → Compress → Write</span>
                            <span class="code-keyword">const</span> zlib = require(<span
                                class="code-string">'zlib'</span>);

                            fs.createReadStream(<span class="code-string">'file.txt'</span>)
                            .pipe(zlib.createGzip())
                            .pipe(fs.createWriteStream(<span class="code-string">'file.txt.gz'</span>));

                            <span class="code-comment">// Multiple transformations</span>
                            fs.createReadStream(<span class="code-string">'data.txt'</span>)
                            .pipe(upperCaseTransform)
                            .pipe(removeSpacesTransform)
                            .pipe(fs.createWriteStream(<span class="code-string">'result.txt'</span>));
                        </div>

                        <div class="interactive-demo">
                            <div class="demo-title">🎮 Simulate Stream Piping:</div>

                            <button class="btn" onclick="demoStreamPipe()">Simple Pipe Demo</button>
                            <button class="btn" onclick="demoStreamTransform()">Transform Pipe Demo</button>

                            <div class="output-box" id="pipe-output"></div>
                        </div>
                    </div>
                </div>

                <div class="topic" onclick="toggleTopic(this)">
                    <div class="topic-header">
                        <span>⚡ Stream Events</span>
                        <span class="toggle-icon">▼</span>
                    </div>
                    <div class="topic-content">
                        <div class="info-box">
                            <strong>📡 Readable Stream Events:</strong>
                            <ul style="margin-top: 10px; margin-left: 20px;">
                                <li><span class="highlight">data</span> - Chunk of data is available</li>
                                <li><span class="highlight">end</span> - No more data to read</li>
                                <li><span class="highlight">error</span> - Error occurred</li>
                                <li><span class="highlight">readable</span> - Data ready to be read</li>
                                <li><span class="highlight">close</span> - Stream closed</li>
                            </ul>
                        </div>

                        <div class="info-box">
                            <strong>📡 Writable Stream Events:</strong>
                            <ul style="margin-top: 10px; margin-left: 20px;">
                                <li><span class="highlight">drain</span> - Safe to write more data</li>
                                <li><span class="highlight">finish</span> - All data has been flushed</li>
                                <li><span class="highlight">error</span> - Error occurred</li>
                                <li><span class="highlight">pipe</span> - Readable stream piped to this</li>
                                <li><span class="highlight">unpipe</span> - Stream unpiped</li>
                            </ul>
                        </div>

                        <div class="code-block">
                            <span class="code-comment">// Listening to stream events</span>
                            <span class="code-keyword">const</span> readStream = fs.createReadStream(<span
                                class="code-string">'large-file.txt'</span>);

                            readStream.on(<span class="code-string">'data'</span>, (chunk) => {
                            console.log(<span class="code-string">`Received ${chunk.length} bytes`</span>);
                            });

                            readStream.on(<span class="code-string">'end'</span>, () => {
                            console.log(<span class="code-string">'Stream ended'</span>);
                            });

                            readStream.on(<span class="code-string">'error'</span>, (err) => {
                            console.error(<span class="code-string">'Stream error:'</span>, err);
                            });

                            readStream.on(<span class="code-string">'close'</span>, () => {
                            console.log(<span class="code-string">'Stream closed'</span>);
                            });
                        </div>

                        <div class="interactive-demo">
                            <div class="demo-title">🎮 Try Stream Events:</div>

                            <button class="btn" onclick="demoStreamEvents()">Simulate Stream Events</button>

                            <div class="output-box" id="events-output"></div>
                        </div>
                    </div>
                </div>

                <div class="topic" onclick="toggleTopic(this)">
                    <div class="topic-header">
                        <span>🎯 Real-World Example: File Copy</span>
                        <span class="toggle-icon">▼</span>
                    </div>
                    <div class="topic-content">
                        <div class="warning-box">
                            <strong>❌ Bad Approach - Without Streams:</strong>
                            <p style="margin-top: 10px;">Loads entire file into memory!</p>
                        </div>

                        <div class="code-block">
                            <span class="code-comment">// ❌ BAD: Memory intensive</span>
                            fs.readFile(<span class="code-string">'large-video.mp4'</span>, (err, data) => {
                            <span class="code-keyword">if</span> (err) <span class="code-keyword">throw</span> err;
                            fs.writeFile(<span class="code-string">'copy.mp4'</span>, data, (err) => {
                            <span class="code-keyword">if</span> (err) <span class="code-keyword">throw</span> err;
                            console.log(<span class="code-string">'Copied!'</span>);
                            });
                            });

                            <span class="code-comment">// Problem: 1GB file = 1GB memory usage! 💥</span>
                        </div>

                        <div class="success-box">
                            <strong>✅ Good Approach - With Streams:</strong>
                            <p style="margin-top: 10px;">Processes in small chunks!</p>
                        </div>

                        <div class="code-block">
                            <span class="code-comment">// ✅ GOOD: Memory efficient</span>
                            <span class="code-keyword">const</span> readStream = fs.createReadStream(<span
                                class="code-string">'large-video.mp4'</span>);
                            <span class="code-keyword">const</span> writeStream = fs.createWriteStream(<span
                                class="code-string">'copy.mp4'</span>);

                            readStream.pipe(writeStream);

                            writeStream.on(<span class="code-string">'finish'</span>, () => {
                            console.log(<span class="code-string">'Copied!'</span>);
                            });

                            <span class="code-comment">// Memory usage: ~64KB (chunk size) ✨</span>
                        </div>

                        <div class="interactive-demo">
                            <div class="demo-title">🎮 Compare Approaches:</div>

                            <button class="btn" onclick="demoWithoutStreams()">Without Streams (Bad)</button>
                            <button class="btn" onclick="demoWithStreams()">With Streams (Good)</button>

                            <div class="output-box" id="copy-output"></div>
                        </div>
                    </div>
                </div>

                <div class="topic" onclick="toggleTopic(this)">
                    <div class="topic-header">
                        <span>⚠️ Backpressure</span>
                        <span class="toggle-icon">▼</span>
                    </div>
                    <div class="topic-content">
                        <p><span class="highlight">Backpressure</span> occurs when the writable stream can't keep up
                            with the readable stream.</p>

                        <div class="warning-box">
                            <strong>⚠️ The Problem:</strong>
                            <p style="margin-top: 10px;">If you read data faster than you can write it, memory will fill
                                up and crash your application!</p>
                        </div>

                        <div class="code-block">
                            <span class="code-comment">// Manual backpressure handling</span>
                            <span class="code-keyword">const</span> readStream = fs.createReadStream(<span
                                class="code-string">'huge-file.txt'</span>);
                            <span class="code-keyword">const</span> writeStream = fs.createWriteStream(<span
                                class="code-string">'output.txt'</span>);

                            readStream.on(<span class="code-string">'data'</span>, (chunk) => {
                            <span class="code-keyword">const</span> canContinue = writeStream.write(chunk);

                            <span class="code-keyword">if</span> (!canContinue) {
                            <span class="code-comment">// Buffer is full, pause reading</span>
                            console.log(<span class="code-string">'Backpressure! Pausing...'</span>);
                            readStream.pause();
                            }
                            });

                            writeStream.on(<span class="code-string">'drain'</span>, () => {
                            <span class="code-comment">// Buffer emptied, resume reading</span>
                            console.log(<span class="code-string">'Drained! Resuming...'</span>);
                            readStream.resume();
                            });
                        </div>

                        <div class="success-box">
                            <strong>✅ Easy Solution:</strong>
                            <p style="margin-top: 10px;">Use <span class="highlight">.pipe()</span> - it handles
                                backpressure automatically!</p>
                        </div>

                        <div class="code-block">
                            <span class="code-comment">// ✅ pipe() handles backpressure for you</span>
                            readStream.pipe(writeStream);
                        </div>
                    </div>
                </div>
            </div>

            <!-- COMPARISON SECTION -->
            <div class="section">
                <h2 class="section-title">
                    <span>⚖️ Buffer vs Stream Comparison</span>
                </h2>

                <div class="topic" onclick="toggleTopic(this)">
                    <div class="topic-header">
                        <span>📊 When to Use What?</span>
                        <span class="toggle-icon">▼</span>
                    </div>
                    <div class="topic-content">
                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th>Feature</th>
                                    <th>Buffer</th>
                                    <th>Stream</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Data Size</strong></td>
                                    <td>Small to medium</td>
                                    <td>Large files</td>
                                </tr>
                                <tr>
                                    <td><strong>Memory Usage</strong></td>
                                    <td>Loads all data</td>
                                    <td>Processes chunks</td>
                                </tr>
                                <tr>
                                    <td><strong>Speed</strong></td>
                                    <td>Faster for small data</td>
                                    <td>Faster for large data</td>
                                </tr>
                                <tr>
                                    <td><strong>Use Cases</strong></td>
                                    <td>Images, small files, encoding</td>
                                    <td>Videos, logs, uploads, downloads</td>
                                </tr>
                                <tr>
                                    <td><strong>Example</strong></td>
                                    <td>Buffer.from('text')</td>
                                    <td>fs.createReadStream()</td>
                                </tr>
                            </tbody>
                        </table>

                        <div class="key-point">
                            <strong>💡 Rule of Thumb:</strong>
                            <ul style="margin-top: 10px; margin-left: 20px;">
                                <li>Use <strong>Buffers</strong> when data fits comfortably in memory (&lt; 1MB)</li>
                                <li>Use <strong>Streams</strong> for large data or when data arrives over time</li>
                                <li>Streams use Buffers internally for chunk storage</li>
                            </ul>
                        </div>

                        <div class="interactive-demo">
                            <div class="demo-title">🎮 Memory Comparison Demo:</div>

                            <button class="btn" onclick="demoMemoryUsage()">Compare Memory Usage</button>

                            <div class="output-box" id="memory-output"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- KEY TAKEAWAYS -->
            <div class="section">
                <h2 class="section-title">
                    <span>📝 Key Takeaways</span>
                </h2>

                <div class="key-point">
                    <strong>📦 Buffers:</strong>
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li>✅ Store binary data in memory</li>
                        <li>✅ Fixed size arrays of bytes</li>
                        <li>✅ Like arrays but for binary data</li>
                        <li>✅ Use for small data manipulation</li>
                        <li>✅ Support multiple encodings (utf8, hex, base64)</li>
                    </ul>
                </div>

                <div class="key-point">
                    <strong>🌊 Streams:</strong>
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li>✅ Process data in chunks</li>
                        <li>✅ Memory efficient for large files</li>
                        <li>✅ Perfect for videos, logs, large datasets</li>
                        <li>✅ Four types: Readable, Writable, Duplex, Transform</li>
                        <li>✅ Can be piped together for powerful data processing</li>
                        <li>✅ Handle backpressure automatically with pipe()</li>
                    </ul>
                </div>

                <div class="success-box">
                    <strong>🎯 Best Practices:</strong>
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li>Always handle errors in both buffers and streams</li>
                        <li>Use pipe() instead of manual data/drain event handling</li>
                        <li>Choose streams for any file larger than a few MB</li>
                        <li>Use Buffer.alloc() instead of Buffer.allocUnsafe() for security</li>
                        <li>Clean up streams properly (destroy/close) to prevent memory leaks</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        function toggleTopic(element) {
            const content = element.querySelector('.topic-content');
            const icon = element.querySelector('.toggle-icon');

            content.classList.toggle('active');
            icon.classList.toggle('active');
        }

        function clearOutput(id) {
            document.getElementById(id).innerHTML = '';
        }

        function addOutput(id, text, type = 'normal') {
            const output = document.getElementById(id);
            const line = document.createElement('div');
            line.className = 'output-line';
            if (type === 'chunk') {
                line.innerHTML = `<span class="chunk">${text}</span>`;
            } else {
                line.textContent = text;
            }
            output.appendChild(line);
        }

        // Initialize buffer visualization
        window.addEventListener('DOMContentLoaded', () => {
            const bufferVisual = document.getElementById('buffer-visual-1');
            const text = 'Hello';
            const buffer = new TextEncoder().encode(text);

            buffer.forEach((byte, index) => {
                const byteDiv = document.createElement('div');
                byteDiv.className = 'buffer-byte';
                byteDiv.textContent = byte.toString(16).toUpperCase().padStart(2, '0');
                byteDiv.title = `Byte ${index}: ${byte} (char: ${text[index]})`;
                bufferVisual.appendChild(byteDiv);
            });
        });

        function createBuffer() {
            const input = document.getElementById('buffer-input').value;
            clearOutput('buffer-output');

            const encoder = new TextEncoder();
            const buffer = encoder.encode(input);

            addOutput('buffer-output', `Text: "${input}"`);
            addOutput('buffer-output', `Buffer length: ${buffer.length} bytes`);
            addOutput('buffer-output', `Buffer content: [${Array.from(buffer).join(', ')}]`);
        }

        function showBufferHex() {
            const input = document.getElementById('buffer-input').value;
            clearOutput('buffer-output');

            const encoder = new TextEncoder();
            const buffer = encoder.encode(input);
            const hex = Array.from(buffer).map(b => b.toString(16).padStart(2, '0')).join(' ');

            addOutput('buffer-output', `Text: "${input}"`);
            addOutput('buffer-output', `Hexadecimal: ${hex}`);
        }

        function showBufferArray() {
            const input = document.getElementById('buffer-input').value;
            clearOutput('buffer-output');

            const encoder = new TextEncoder();
            const buffer = encoder.encode(input);

            addOutput('buffer-output', `Text: "${input}"`);
            addOutput('buffer-output', 'ASCII codes:');
            Array.from(buffer).forEach((byte, i) => {
                addOutput('buffer-output', `  [${i}] = ${byte} (${input[i]})`);
            });
        }

        function demoBufferSlice() {
            clearOutput('buffer-methods-output');

            const text = 'Hello World';
            const encoder = new TextEncoder();
            const buffer = encoder.encode(text);

            addOutput('buffer-methods-output', `Original: "${text}"`);

            const decoder = new TextDecoder();
            const sliced1 = buffer.slice(0, 5);
            addOutput('buffer-methods-output', `slice(0, 5): "${decoder.decode(sliced1)}"`);

            const sliced2 = buffer.slice(6);
            addOutput('buffer-methods-output', `slice(6): "${decoder.decode(sliced2)}"`);
        }

        function demoBufferConcat() {
            clearOutput('buffer-methods-output');

            const encoder = new TextEncoder();
            const buf1 = encoder.encode('Hello ');
            const buf2 = encoder.encode('World');
            const buf3 = encoder.encode('!');

            const combined = new Uint8Array([...buf1, ...buf2, ...buf3]);
            const decoder = new TextDecoder();

            addOutput('buffer-methods-output', `Buffer 1: "Hello "`);
            addOutput('buffer-methods-output', `Buffer 2: "World"`);
            addOutput('buffer-methods-output', `Buffer 3: "!"`);
            addOutput('buffer-methods-output', `Combined: "${decoder.decode(combined)}"`);
        }

        function demoBufferCopy() {
            clearOutput('buffer-methods-output');

            const encoder = new TextEncoder();
            const source = encoder.encode('Copy Me');
            const target = new Uint8Array(7);

            target.set(source);
            const decoder = new TextDecoder();

            addOutput('buffer-methods-output', `Source: "${decoder.decode(source)}"`);
            addOutput('buffer-methods-output', `Copied to target: "${decoder.decode(target)}"`);
        }

        function demoBufferEncodings() {
            clearOutput('buffer-methods-output');

            const text = 'Hello';
            const encoder = new TextEncoder();
            const buffer = encoder.encode(text);

            addOutput('buffer-methods-output', `Text: "${text}"`);
            addOutput('buffer-methods-output', `UTF-8: ${text}`);
            addOutput('buffer-methods-output', `Hex: ${Array.from(buffer).map(b => b.toString(16).padStart(2, '0')).join('')}`);
            addOutput('buffer-methods-output', `Base64: ${btoa(text)}`);
            addOutput('buffer-methods-output', `Array: [${Array.from(buffer).join(', ')}]`);
        }

        function demoStreamPipe() {
            clearOutput('pipe-output');

            addOutput('pipe-output', '📖 Source: Reading data...');

            let chunkCount = 0;
            const interval = setInterval(() => {
                chunkCount++;
                if (chunkCount <= 3) {
                    addOutput('pipe-output', `  → Chunk ${chunkCount} flowing through pipe`, 'chunk');
                } else {
                    clearInterval(interval);
                    addOutput('pipe-output', '✅ Destination: All data written!');
                }
            }, 500);
        }

        function demoStreamTransform() {
            clearOutput('pipe-output');

            addOutput('pipe-output', '📖 Source: "hello world"');
            addOutput('pipe-output', '🔄 Transform: Converting to uppercase...');

            setTimeout(() => {
                addOutput('pipe-output', '  → Processing...', 'chunk');
            }, 500);

            setTimeout(() => {
                addOutput('pipe-output', '✅ Destination: "HELLO WORLD"');
            }, 1000);
        }

        function demoStreamEvents() {
            clearOutput('events-output');

            addOutput('events-output', '🎬 Stream starting...');

            setTimeout(() => addOutput('events-output', '📡 Event: "data" - Chunk 1 received'), 300);
            setTimeout(() => addOutput('events-output', '📡 Event: "data" - Chunk 2 received'), 600);
            setTimeout(() => addOutput('events-output', '📡 Event: "data" - Chunk 3 received'), 900);
            setTimeout(() => addOutput('events-output', '📡 Event: "end" - No more data'), 1200);
            setTimeout(() => addOutput('events-output', '📡 Event: "close" - Stream closed'), 1500);
        }

        function demoWithoutStreams() {
            clearOutput('copy-output');

            addOutput('copy-output', '❌ Without Streams:');
            addOutput('copy-output', '📖 Reading entire file into memory...');
            addOutput('copy-output', '⏳ Loading 1GB file...');
            addOutput('copy-output', '💾 Memory usage: 1GB');

            setTimeout(() => {
                addOutput('copy-output', '✍️ Writing entire file...');
                addOutput('copy-output', '⚠️ Risk: Out of memory error!');
            }, 1500);
        }

        function demoWithStreams() {
            clearOutput('copy-output');

            addOutput('copy-output', '✅ With Streams:');
            addOutput('copy-output', '📖 Reading in chunks...');

            let chunks = 0;
            const interval = setInterval(() => {
                chunks++;
                if (chunks <= 5) {
                    addOutput('copy-output', `  Chunk ${chunks}: Read 64KB, Write 64KB`, 'chunk');
                    addOutput('copy-output', `  💾 Memory: 64KB (constant)`);
                } else {
                    clearInterval(interval);
                    addOutput('copy-output', '✅ Complete! Memory efficient!');
                }
            }, 400);
        }

        function demoMemoryUsage() {
            clearOutput('memory-output');

            addOutput('memory-output', '📊 Copying 1GB file:');
            addOutput('memory-output', '');
            addOutput('memory-output', '❌ Buffer Approach:');
            addOutput('memory-output', '  Memory needed: 1GB');
            addOutput('memory-output', '  Time to start: Wait for full load');
            addOutput('memory-output', '  Risk: May crash on large files');
            addOutput('memory-output', '');
            addOutput('memory-output', '✅ Stream Approach:');
            addOutput('memory-output', '  Memory needed: 64KB (chunk size)');
            addOutput('memory-output', '  Time to start: Immediate');
            addOutput('memory-output', '  Risk: None, handles any file size');
            addOutput('memory-output', '');
            addOutput('memory-output', '💡 Winner: Streams (15,625x less memory!)');
        }
    </script>
</body>

</html>